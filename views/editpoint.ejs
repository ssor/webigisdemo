
<!DOCTYPE html>
<html lang="en" style="height:100%;">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- <link rel="shortcut icon" href="../../docs-assets/ico/favicon.png"> -->

    <title>路线编辑</title>

    <!-- Bootstrap core CSS -->
    <link href="/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">    
    <!-- Bootstrap theme -->
    <link rel='stylesheet' href='/bootstrap/css/bootstrap-theme.css' />

    <!-- Custom styles for this template -->
    <link href="/stylesheets/theme-webgis.css" rel="stylesheet">
    <script type="text/javascript" src="http://api.go2map.com/maps/js/api_v2.5.1.js"></script>
    <script type="text/javascript">
      var map;
      var points = new Array();
      function initialize() {
        //bwu 12983703.125  4827636.71875
        // var myLatlng = new sogou.maps.LatLng(39.992792,116.326142);
        var myLatlng = new sogou.maps.Point(12983703.125, 4827636.71875);
        var myOptions = {
          zoom: 12,
          center: myLatlng,
          mapTypeId: sogou.maps.MapTypeId.ROADMAP
        }
        map = new sogou.maps.Map(document.getElementById("map_canvas"), myOptions);
         
        sogou.maps.event.addListener(map, 'click', function(event) {
          //获取点击位置的坐标
          // alert(event.point)
          // postjson(event.point.y, event.point.x);
          placeMarker(event.point);
          points.push(event.point);
        });
      }
       
      function placeMarker(location) {
        var clickedLocation = location;
        var marker = new sogou.maps.Marker({
            position: location,
            map: map
        });
       
        map.setCenter(location);
        $('#lbllat').text(location.y);
        $('#lbllng').text(location.x);
      }
      function outputPoint(lat, lng, index, road_name){
        this.Lat = lat;
        this.Lng = lng;
        this.RoadName = road_name;
        this.IndexInList = index;
      }
      function postjson(lat, lng){
        $.post("/postSogouGps", { carID: "A123456", Lat: lat, Lng: lng }, function (data) {
          // alert(data.status);
        });
      }
      function clearPoints(){
        points.length = 0;
        map.clearAll();
      }
      function exportPoints(){
        // $.post('/exportPoints', {type:'sogou-point', data:JSON.stringify(points)}, function(data){
        //     if(data.status == 'success'){
        //       $('#div-output').text(data.content);
        //     }
        // });
        // var roadName = "设置路名";
        var road1 = "未知道路1";
        var road2 = "未知道路2";
        var nextRoadNameList = [road1, road2];
        var roadName = $('#road-name').val();
        var pointListArray = new Array();
        for (var i = 0; i < points.length; i++) {
          var point = points[i];
          pointListArray.push(new outputPoint(point.y, point.x, i, roadName));
        };
        $('#div-output').text(JSON.stringify({RoadName:roadName, NextRoadNameList:JSON.stringify(nextRoadNameList), PointList: pointListArray}));
      }
    </script>
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="../../docs-assets/js/html5shiv.js"></script>
      <script src="../../docs-assets/js/respond.min.js"></script>
    <![endif]-->
  </head>

  <body onload="initialize()">

    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">路线编辑</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li></li>
            <!-- <li class="active"><a style="font-size:22px;" href="#">京A-12345</a></li> -->
            <li><a href="#" onclick="exportPoints()">导出</a></li>
            <li><a href="#" onclick="clearPoints()">清除</a></li>
            <form class="navbar-form navbar-left" role="search">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="当前道路名称" id = "road-name">
              </div>
              <!-- <button type="submit" class="btn btn-default">Submit</button> -->
            </form>

          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li><a id = "lbllng" href="#"></a></li>
            <li><a id = "lbllat" href=""></a></li>
          </ul>

        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container theme-showcase" style="height:100%;">
    <!-- <div class="span1" style="height:98%;"></div> -->
<!--       <div style="background-color: gainsboro;
height: 35px;
line-height: 35px;
text-align: center;
font-size: 22px;
margin-bottom: 1px;">
        <p>京A-12345</p>
      </div> -->
      <div id="map_canvas" class='span8 offset2' style="height:90%;"></div>
      <div class="well" style="margin-top:5px;" id = 'div-output'>
      </div>
    </div> <!-- /container -->
<!--     <div class="page-header">
        <h1>输出</h1>
      </div> -->

<!--     <footer class="container" role="contentinfo">
    <div style = "text-align: center;">北京ABC智能物联网有限公司</div>
    </footer> -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" src = "/javascripts/jquery.js"></script>
    <script src="/bootstrap/js/bootstrap.js"></script>                         
    <script type="text/javascript" src = "/javascripts/holder.js"></script>

    <!-- // <script src="../../docs-assets/js/jquery.js"></script> -->
    <!-- // <script src="../../dist/js/bootstrap.min.js"></script> -->
    <!-- // <script src="../../docs-assets/js/holder.js"></script> -->
  </body>
</html>
